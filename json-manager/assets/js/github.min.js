const TOKEN_KEY="json_tupa_token";function getStoredToken(){return localStorage.getItem(TOKEN_KEY)}function setStoredToken(token){localStorage.setItem(TOKEN_KEY,token)}function clearStoredToken(){localStorage.removeItem(TOKEN_KEY)}async function githubRequest(path,options={}){const token=getStoredToken();if(!token){throw new Error("Token nao encontrado. Faca login novamente.")}const response=await fetch(`https://api.github.com${path}`,{method:options.method||"GET",cache:"no-store",headers:{Accept:"application/vnd.github+json",Authorization:`Bearer ${token}`,"X-GitHub-Api-Version":"2022-11-28","Content-Type":"application/json"},body:options.body?JSON.stringify(options.body):undefined});if(!response.ok){const message=await response.text();throw new Error(`GitHub API: ${response.status} - ${message}`)}return response.json()}async function listRepoContents(owner,repo,path){return githubRequest(`/repos/${owner}/${repo}/contents/${path}`)}async function getRepo(owner,repo){return githubRequest(`/repos/${owner}/${repo}`)}async function getRepoFile(owner,repo,path){return githubRequest(`/repos/${owner}/${repo}/contents/${path}`)}async function upsertRepoFile(owner,repo,path,content,sha,message,branch){return githubRequest(`/repos/${owner}/${repo}/contents/${path}`,{method:"PUT",body:{message:message,content:content,sha:sha,branch:branch}})}async function listWorkflows(owner,repo){return githubRequest(`/repos/${owner}/${repo}/actions/workflows`)}async function dispatchWorkflow(owner,repo,workflowId,ref){return githubRequest(`/repos/${owner}/${repo}/actions/workflows/${workflowId}/dispatches`,{method:"POST",body:{ref:ref}})}function decodeBase64Content(encoded){const decoded=atob(encoded.replace(/\n/g,""));return decodeURIComponent(decoded.split("").map(c=>`%${`00${c.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""))}function encodeBase64Content(text){const encoded=encodeURIComponent(text).replace(/%([0-9A-F]{2})/g,(match,p1)=>String.fromCharCode(`0x${p1}`));return btoa(encoded)}